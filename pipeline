#!/bin/bash

case "$1" in
    init)
        chmod 755 pipeline/parallel
#        chmod 755 pipeline/utils/kv
        chmod 755 pipeline/stage.r
        chmod 755 pipeline/splits/*
        chmod 755 pipeline/methods/fm/bin/libFM
        chmod 755 pipeline/methods/vw/vw
        mkdir -p config
        mkdir -p features
        mkdir -p logs
        mkdir -p predictions
        mkdir -p splits
        touch config/datasets
        touch config/methods
        touch config/queue
        ;;
    status)
        cat queue
        ;;
#    add)
#        if [ "$2" == "dataset" ] ; then
#            ./utils/kv add config/datasets "$3"
#        elif [ "$2" == "method" ] ; then
#            ./utils/kv add config/methods "$3"
#        fi
#        ;;
#    remove)
#        if [ "$2" == "dataset" ] ; then
#            ./utils/kv remove config/datasets "$3"
#        elif [ "$2" == "method" ] ; then
#            ./utils/kv remove config/methods "$3"
#        fi
#        ;;
    split) 
        ./pipeline/splits/$2 --K $3 $4
        ;;
    stage) 
        ./pipeline/stage.r --method "all" --dataset "all"
        ;;
    push) 
        ./pipeline/remotes/datalab
        ;;
    *)
        echo "usage: $0 { }"
        ;;
esac
exit 0
